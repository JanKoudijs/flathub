id: org.freedesktop.Sdk.Extension.rustup-stable-minimal
branch: '24.08'
runtime: org.freedesktop.Sdk
build-extension: true
sdk: org.freedesktop.Sdk
runtime-version: '24.08'
separate-locales: false
appstream-compose: false
cleanup:
  - /downloads
  - /tmp
build-options:
  append-path: /usr/lib/sdk/rustup-stable-minimal/bin
  env:
    CARGO_HOME: /usr/lib/sdk/rustup-stable-minimal
    RUSTUP_HOME: /usr/lib/sdk/rustup-stable-minimal
    RUSTUP_DIST_SERVER: file:///run/build/rustup/static.rust-lang.org
modules:
  - name: rustup
    buildsystem: simple
    build-commands:
      - chmod +x rustup-init && ./rustup-init -y --profile minimal --no-modify-path
      - install -D org.freedesktop.Sdk.Extension.rustup-stable-minimal.metainfo.xml ${FLATPAK_DEST}/share/metainfo/org.freedesktop.Sdk.Extension.rustup-stable-minimal.metainfo.xml
    sources:
      - type: file
        only-arches:
          - x86_64
        url: https://static.rust-lang.org/rustup/dist/x86_64-unknown-linux-gnu/rustup-init
        sha256: 6aeece6993e902708983b209d04c0d1dbb14ebb405ddb87def578d41f920f56d
        dest-filename: rustup-init
      - type: file
        only-arches:
          - aarch64
        url: https://static.rust-lang.org/rustup/dist/aarch64-unknown-linux-gnu/rustup-init
        sha256: 1cffbf51e63e634c746f741de50649bbbcbd9dbe1de363c9ecef64e278dba2b2
        dest-filename: rustup-init
      - type: file
        url: https://static.rust-lang.org/dist/channel-rust-stable.toml
        sha256: b3544fb72bc3189697fc18ac2d3fa27d57ee8434f59d9919d4d70af2c6f010b3
        dest: static.rust-lang.org/dist
      - type: file
        url: https://static.rust-lang.org/dist/channel-rust-stable.toml.sha256
        sha256: 627276a6bdb40a93310984ed6d807ec921e37df387266ad2a92ab73b1f563514
        dest: static.rust-lang.org/dist
      - type: file
        path: org.freedesktop.Sdk.Extension.rustup-stable-minimal.metainfo.xml
      - rustup-stable-minimal.json
